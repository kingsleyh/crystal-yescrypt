require "./spec_helper"

include Hashing
describe Crypto do
  it "should produce an hmac 256 digest" do
    Crypto.hmac_sha256("key", "message").should eq(Bytes[110, 158, 242, 155, 117, 255, 252, 91, 122, 186, 229, 39, 213, 143, 218, 219, 47, 228, 46, 114, 25, 1, 25, 118, 145, 115, 67, 6, 95, 88, 237, 74])
  end
  it "should produce a pbkdf2 sha256 digest" do
    Crypto.pbkdf2_sha256("password", "salt", 2, 128).should eq(Bytes[174, 77, 12, 149, 175, 107, 70, 211, 45, 10, 223, 249, 40, 240, 109, 208, 42, 48, 63, 142, 243, 194, 81, 223, 214, 226, 216, 90, 149, 71, 76, 67, 131, 6, 81, 175, 203, 92, 134, 47, 11, 36, 155, 208, 49, 247, 166, 117, 32, 209, 54, 71, 15, 94, 194, 113, 236, 233, 28, 7, 119, 50, 83, 217, 62, 103, 107, 7, 156, 174, 18, 25, 160, 0, 248, 180, 177, 160, 163, 186, 94, 166, 89, 2, 245, 124, 57, 227, 114, 100, 175, 158, 108, 228, 162, 130, 180, 76, 215, 50, 224, 209, 10, 8, 216, 123, 96, 78, 168, 164, 237, 96, 230, 227, 22, 86, 66, 228, 249, 226, 188, 146, 40, 42, 30, 143, 160, 27])
  end
end
